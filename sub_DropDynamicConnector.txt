
Sub DropDynamicConnector(connectorType As String, arrowType As String, fontSize As String)
' Connector Shape handle
StartX = 5 + Rnd() * 2
StartY = 2 + Rnd() * 2

Dim vsoShape As Visio.Shape
Set vsoShape = ActivePage.Drop(Visio.Application.ConnectorToolDataObject, StartX, StartY)
    vsoShape.CellsSRC(visSectionObject, visRowShapeLayout, visSLOLineRouteExt).FormulaU = connectorType
    vsoShape.CellsSRC(visSectionObject, visRowShapeLayout, visSLORouteStyle).FormulaU = "16"
    vsoShape.CellsSRC(visSectionObject, visRowLine, visLineWeight).FormulaU = "1.5 pt"
    vsoShape.CellsSRC(visSectionObject, visRowLine, visLineEndArrow).FormulaU = arrowType
    vsoShape.Characters.Begin = 0
    vsoShape.Characters.End = 0
    vsoShape.Characters.Text = vsoShape.Name
    vsoShape.CellsSRC(visSectionObject, visRowText, visTxtFontSize).FormulaU = fontSize & " pt"
    
    BeginX = vsoShape.Cells("BeginX").Result("mm")
    BeginY = vsoShape.Cells("BeginY").Result("mm")
    t = CStr(BeginY) & " " & "mm"
    t1 = Replace(t, ",", ".")
    
    'vsoShape.CellsSRC(visSectionObject, visRowXForm1D, vis1DEndX).FormulaU =
    vsoShape.CellsSRC(visSectionObject, visRowXForm1D, vis1DEndY).FormulaU = t1
     

Sub ShowForm()
    frmDropDynamicConnector.Show
End Sub
